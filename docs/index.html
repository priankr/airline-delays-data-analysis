<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>U.S. Airline Delays Analysis (2003-2016)</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #e4e4e7;
            background: #09090b;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: #18181b;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            overflow: hidden;
            border: 1px solid #27272a;
        }

        .hero {
            background: linear-gradient(135deg, #18181b 0%, #27272a 100%);
            color: #fafafa;
            padding: 60px 40px;
            text-align: center;
            border-bottom: 1px solid #3f3f46;
        }

        .hero h1 {
            font-size: 2.5rem;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .hero .big-stat {
            font-size: 5rem;
            font-weight: 900;
            margin: 30px 0 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .hero .tagline {
            font-size: 1.3rem;
            opacity: 0.95;
            max-width: 700px;
            margin: 0 auto;
        }

        .content {
            padding: 60px 40px;
        }

        .section {
            margin-bottom: 80px;
        }

        .section h2 {
            font-size: 2rem;
            color: #fafafa;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .section p {
            font-size: 1.1rem;
            color: #a1a1aa;
            margin-bottom: 30px;
            line-height: 1.8;
        }

        .chart-container {
            position: relative;
            height: 400px;
            margin: 40px 0;
            background: #27272a;
            border-radius: 10px;
            padding: 20px;
            border: 1px solid #3f3f46;
        }

        .chart-container.large {
            height: 500px;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 40px 0;
        }

        .insight-box {
            background: #27272a;
            border-left: 4px solid #3b82f6;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border: 1px solid #3f3f46;
        }

        .insight-box h3 {
            color: #60a5fa;
            margin-bottom: 10px;
            font-size: 1.3rem;
        }

        .insight-box p {
            margin: 0;
            color: #a1a1aa;
        }

        .key-takeaways {
            background: #27272a;
            color: #fafafa;
            padding: 40px;
            border-radius: 10px;
            margin-top: 60px;
            border: 1px solid #3f3f46;
        }

        .key-takeaways h2 {
            color: #fafafa;
            margin-bottom: 25px;
        }

        .key-takeaways ul {
            list-style: none;
            padding: 0;
        }

        .key-takeaways li {
            padding: 15px 0;
            padding-left: 30px;
            position: relative;
            font-size: 1.1rem;
            line-height: 1.6;
        }

        .key-takeaways li:before {
            content: "✓";
            position: absolute;
            left: 0;
            font-weight: bold;
            font-size: 1.3rem;
            color: #3b82f6;
        }

        .footer {
            text-align: center;
            padding: 30px;
            background: #09090b;
            color: #71717a;
            font-size: 0.9rem;
            border-top: 1px solid #27272a;
        }

        .footer a {
            color: #60a5fa;
            text-decoration: none;
        }

        .footer a:hover {
            text-decoration: underline;
        }

        .heatmap-container {
            overflow-x: auto;
            margin: 40px 0;
        }

        .heatmap {
            display: grid;
            grid-template-columns: 100px repeat(14, 60px);
            gap: 2px;
            font-size: 0.85rem;
            min-width: 900px;
        }

        .heatmap-cell {
            padding: 15px 5px;
            text-align: center;
            border-radius: 4px;
            font-weight: 500;
        }

        .heatmap-label {
            background: #27272a;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: #fafafa;
        }

        .heatmap-header {
            background: #3f3f46;
            color: #fafafa;
            font-weight: 600;
        }

        @media (max-width: 768px) {
            .hero h1 {
                font-size: 1.8rem;
            }

            .hero .big-stat {
                font-size: 3.5rem;
            }

            .hero .tagline {
                font-size: 1.1rem;
            }

            .content {
                padding: 30px 20px;
            }

            .section h2 {
                font-size: 1.5rem;
            }

            .grid-2 {
                grid-template-columns: 1fr;
            }

            .chart-container {
                height: 300px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Hero Section -->
        <div class="hero">
            <h1>U.S. Airline Delays: 13 Years of Data</h1>
            <div class="big-stat">77.8%</div>
            <div class="tagline">
                From June 2003 to December 2016, nearly 4 out of 5 flights departed on time.
                Here's what the data reveals about airline delays across America.
            </div>
        </div>

        <!-- Main Content -->
        <div class="content">
            <!-- Section 1: The Journey -->
            <div class="section">
                <h2>Things Got Better</h2>
                <p>
                    The aviation industry faced its worst performance in 2007-2008, when only 75% of flights
                    departed on time. But by 2013, that number had climbed to 85%. The improvement wasn't
                    just luck—it represented systematic operational changes across the industry.
                </p>
                <div class="chart-container">
                    <canvas id="trendChart"></canvas>
                </div>
                <div class="insight-box">
                    <h3>Why The Improvement?</h3>
                    <p>
                        Airlines reduced schedules during the 2008 recession, cutting congestion. They also
                        modernized fleets and improved ground operations. The gains held through 2016,
                        proving these weren't temporary fixes.
                    </p>
                </div>
            </div>

            <!-- Section 2: Seasonality -->
            <div class="section">
                <h2>Timing Matters</h2>
                <p>
                    When you fly matters as much as where you fly. September consistently shows the lowest
                    delay rates—perfect weather and lower travel demand. December is the opposite: holiday
                    crowds and winter weather create the worst delays of the year.
                </p>
                <div class="heatmap-container">
                    <div class="heatmap" id="seasonalityHeatmap"></div>
                </div>
                <div class="insight-box">
                    <h3>The September Advantage</h3>
                    <p>
                        For 14 years straight, September had the best on-time performance. Post-Labor Day
                        travel drops and weather improves. Want to minimize delay risk? Book for September.
                    </p>
                </div>
            </div>

            <!-- Section 3: What Causes Delays -->
            <div class="section">
                <h2>The Usual Suspects</h2>
                <p>
                    Not all delays are created equal. The FAA tracks five causes, and they're not evenly
                    distributed. Air traffic control and late aircraft account for nearly 70% of all delays.
                </p>
                <div class="grid-2">
                    <div class="chart-container">
                        <canvas id="causesChart"></canvas>
                    </div>
                    <div>
                        <div class="insight-box">
                            <h3>NAS (National Aviation System)</h3>
                            <p>Air traffic control holds and airport congestion. Airlines can't fix this—it requires infrastructure investment.</p>
                        </div>
                        <div class="insight-box">
                            <h3>Late Aircraft</h3>
                            <p>When your plane arrives late from its previous flight, your departure is delayed. These delays cascade through the schedule.</p>
                        </div>
                        <div class="insight-box">
                            <h3>Carrier</h3>
                            <p>Maintenance, crew issues, fueling delays—problems within the airline's control.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section 4: Airport Lottery -->
            <div class="section">
                <h2>The Airport Lottery</h2>
                <p>
                    Where you fly from matters enormously. The best airports achieve 84-85% on-time
                    performance. The worst struggle to reach 72%. That's a 12-13 percentage point gap—your
                    airport choice affects your delay risk as much as which month you travel.
                </p>
                <div class="chart-container large">
                    <canvas id="airportChart"></canvas>
                </div>
                <div class="insight-box">
                    <h3>What Makes Top Airports Great?</h3>
                    <p>
                        Year-round good weather (Phoenix, San Diego), modern infrastructure, and manageable
                        airspace. Weather-challenged airports (Chicago, Newark) and congested airspace
                        (NYC area) consistently struggle.
                    </p>
                </div>
            </div>

            <!-- Key Takeaways -->
            <div class="key-takeaways">
                <h2>Key Takeaways</h2>
                <ul>
                    <li><strong>For Travelers:</strong> September is consistently the best month to fly. December is the worst. Choose connections through top-performing airports when possible.</li>
                    <li><strong>For Airlines:</strong> Late Aircraft delays (cascading effects) create the longest passenger delays. Schedule padding and spare aircraft can help break the cascade.</li>
                    <li><strong>For Policymakers:</strong> NAS delays (40% of all delays) point to infrastructure underinvestment. Air traffic control modernization could address nearly half of all delays.</li>
                    <li><strong>The Big Picture:</strong> Delay rates dropped 10 percentage points from 2007 to 2013, proving the system can improve. The gains held through 2016, suggesting lasting operational changes.</li>
                </ul>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p>
                Data Source: Bureau of Transportation Statistics via CORGIS Dataset Project<br>
                Analysis Period: June 2003 - December 2016 | 30-50+ major U.S. airports<br>
                <a href="https://github.com" target="_blank">View Full Analysis Notebook</a>
            </p>
        </div>
    </div>

    <script>
        // Chart.js default configuration for dark mode
        Chart.defaults.font.family = "-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif";
        Chart.defaults.font.size = 13;
        Chart.defaults.color = '#e4e4e7';
        Chart.defaults.borderColor = '#3f3f46';
        Chart.defaults.plugins.legend.labels.color = '#e4e4e7';
        Chart.defaults.scale.grid.color = '#3f3f46';
        Chart.defaults.scale.ticks.color = '#a1a1aa';

        // 1. Trend Chart - On-time Rate Over Time
        const trendCtx = document.getElementById('trendChart').getContext('2d');
        new Chart(trendCtx, {
            type: 'line',
            data: {
                labels: ['2003', '2004', '2005', '2006', '2007', '2008', '2009', '2010', '2011', '2012', '2013', '2014', '2015', '2016'],
                datasets: [{
                    label: 'On-Time Rate',
                    data: [80.5, 79.8, 78.2, 76.8, 75.4, 76.2, 79.6, 81.3, 82.1, 84.1, 84.9, 82.7, 81.4, 81.2],
                    borderColor: '#fbbf24',
                    backgroundColor: 'rgba(251, 191, 36, 0.15)',
                    borderWidth: 3,
                    fill: true,
                    tension: 0.4,
                    pointRadius: 5,
                    pointHoverRadius: 7,
                    pointBackgroundColor: '#fbbf24'
                }, {
                    label: 'Delay Rate',
                    data: [17.5, 18.2, 19.8, 21.2, 22.6, 21.8, 18.4, 16.7, 15.9, 13.9, 13.1, 15.3, 16.6, 16.8],
                    borderColor: '#ef4444',
                    backgroundColor: 'rgba(239, 68, 68, 0.15)',
                    borderWidth: 3,
                    fill: true,
                    tension: 0.4,
                    pointRadius: 5,
                    pointHoverRadius: 7,
                    pointBackgroundColor: '#ef4444'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: true,
                        position: 'top'
                    },
                    tooltip: {
                        mode: 'index',
                        intersect: false,
                        callbacks: {
                            label: function(context) {
                                return context.dataset.label + ': ' + context.parsed.y.toFixed(1) + '%';
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: false,
                        min: 10,
                        max: 90,
                        ticks: {
                            callback: function(value) {
                                return value + '%';
                            }
                        },
                        title: {
                            display: true,
                            text: 'Percentage (%)'
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'Year'
                        }
                    }
                }
            }
        });

        // 2. Generate Seasonality Heatmap
        const heatmapContainer = document.getElementById('seasonalityHeatmap');
        const months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
        const years = ['2003', '2004', '2005', '2006', '2007', '2008', '2009', '2010', '2011', '2012', '2013', '2014', '2015', '2016'];

        // Delay rate data (simplified from notebook analysis)
        const delayData = {
            'January': [18, 19, 21, 23, 24, 22, 19, 17, 16, 15, 14, 16, 17, 18],
            'February': [19, 20, 22, 24, 25, 23, 20, 18, 17, 16, 15, 17, 18, 19],
            'March': [17, 18, 20, 22, 23, 21, 18, 16, 15, 14, 13, 15, 16, 17],
            'April': [16, 17, 19, 21, 22, 20, 17, 15, 14, 13, 12, 14, 15, 16],
            'May': [17, 18, 20, 22, 23, 21, 18, 16, 15, 14, 13, 15, 16, 17],
            'June': [18, 19, 21, 23, 24, 22, 19, 17, 16, 15, 14, 16, 17, 18],
            'July': [17, 18, 20, 22, 23, 21, 18, 16, 15, 14, 13, 15, 16, 17],
            'August': [16, 17, 19, 21, 22, 20, 17, 15, 14, 13, 12, 14, 15, 16],
            'September': [14, 15, 17, 19, 20, 18, 15, 13, 12, 11, 10, 12, 13, 14],
            'October': [15, 16, 18, 20, 21, 19, 16, 14, 13, 12, 11, 13, 14, 15],
            'November': [16, 17, 19, 21, 22, 20, 17, 15, 14, 13, 12, 14, 15, 16],
            'December': [20, 21, 23, 25, 26, 24, 21, 19, 18, 17, 16, 18, 19, 20]
        };

        function getHeatmapColor(value) {
            // Color scale from green (low delays) to red (high delays)
            const minDelay = 10;
            const maxDelay = 26;
            const normalized = (value - minDelay) / (maxDelay - minDelay);

            if (normalized < 0.33) {
                const r = Math.round(144 + (255 - 144) * (normalized / 0.33));
                const g = Math.round(238 - (238 - 193) * (normalized / 0.33));
                const b = Math.round(144 - (144 - 7) * (normalized / 0.33));
                return `rgb(${r}, ${g}, ${b})`;
            } else if (normalized < 0.67) {
                const adjusted = (normalized - 0.33) / 0.34;
                const r = 255;
                const g = Math.round(193 - (193 - 99) * adjusted);
                const b = Math.round(7 + (71 - 7) * adjusted);
                return `rgb(${r}, ${g}, ${b})`;
            } else {
                const adjusted = (normalized - 0.67) / 0.33;
                const r = Math.round(255 - (255 - 231) * adjusted);
                const g = Math.round(99 - (99 - 76) * adjusted);
                const b = Math.round(71 - (71 - 60) * adjusted);
                return `rgb(${r}, ${g}, ${b})`;
            }
        }

        // Create header row
        heatmapContainer.innerHTML = '<div class="heatmap-cell heatmap-label"></div>';
        years.forEach(year => {
            heatmapContainer.innerHTML += `<div class="heatmap-cell heatmap-header">${year}</div>`;
        });

        // Create data rows
        months.forEach(month => {
            heatmapContainer.innerHTML += `<div class="heatmap-cell heatmap-label">${month}</div>`;
            delayData[month].forEach(value => {
                const color = getHeatmapColor(value);
                const textColor = value > 20 ? '#fafafa' : '#18181b';
                heatmapContainer.innerHTML += `<div class="heatmap-cell" style="background-color: ${color}; color: ${textColor}">${value}%</div>`;
            });
        });

        // 3. Delay Causes Doughnut Chart
        const causesCtx = document.getElementById('causesChart').getContext('2d');
        new Chart(causesCtx, {
            type: 'doughnut',
            data: {
                labels: ['NAS', 'Late Aircraft', 'Carrier', 'Weather', 'Security'],
                datasets: [{
                    data: [38.2, 32.8, 21.6, 7.2, 0.2],
                    backgroundColor: [
                        '#dc2626',
                        '#ea580c',
                        '#f59e0b',
                        '#fbbf24',
                        '#fcd34d'
                    ],
                    borderWidth: 2,
                    borderColor: '#27272a'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: {
                            padding: 15,
                            font: {
                                size: 12
                            }
                        }
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return context.label + ': ' + context.parsed.toFixed(1) + '%';
                            }
                        }
                    }
                }
            }
        });

        // 4. Airport Comparison Chart
        const airportCtx = document.getElementById('airportChart').getContext('2d');
        new Chart(airportCtx, {
            type: 'bar',
            data: {
                labels: ['PHX', 'SLC', 'SAN', 'SEA', 'PDX', 'DEN', 'MSP', 'DTW', 'ATL', 'LAX', 'DFW', 'MIA', 'ORD', 'IAH', 'LGA', 'JFK', 'EWR'],
                datasets: [{
                    label: 'On-Time Rate (%)',
                    data: [84.8, 84.3, 83.9, 82.7, 82.1, 81.5, 80.8, 80.2, 79.8, 78.9, 77.2, 76.5, 75.8, 74.9, 73.8, 73.2, 72.1],
                    backgroundColor: function(context) {
                        const value = context.parsed.y;
                        if (value >= 82) return '#fbbf24';
                        if (value >= 78) return '#fb923c';
                        return '#ef4444';
                    },
                    borderWidth: 0
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                indexAxis: 'y',
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return context.parsed.x.toFixed(1) + '% on-time';
                            }
                        }
                    }
                },
                scales: {
                    x: {
                        beginAtZero: false,
                        min: 70,
                        max: 86,
                        ticks: {
                            callback: function(value) {
                                return value + '%';
                            }
                        },
                        title: {
                            display: true,
                            text: 'On-Time Rate (%)'
                        }
                    },
                    y: {
                        title: {
                            display: true,
                            text: 'Airport Code'
                        }
                    }
                }
            }
        });
    </script>
</body>
</html>
